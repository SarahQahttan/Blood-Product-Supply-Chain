clc;
clear;

%%                   weight
%                  main Criteria
Cm=[5	1	3	4	1	4	3
    5	1	3	3	2	4	4
    5	1	2	4	1	5	3];
[CCm, resultsm]=swara(Cm);
%                  SubCriteria
C=[1	4	2	1	4	5	4	3	3	1	2	4	4	2	2	1	1	3	4	5	3	1	1	2	3	2	4	4	3	1	3	1	2
    1	5	2	2	5	5	4	3	2	1	2	5	4	2	1	1	2	3	3	5	4	2	1	2	3	2	5	4	4	1	3	1	2
    1	5	3	1	4	4	4	3	3	1	1	5	4	2	1	1	2	2	3	5	3	1	1	1	3	3	4	3	3	1	4	1	1];
[CC1, results1]=swara(C(:,1:3));
[CC2, results2]=swara(C(:,4:11));
[CC3, results3]=swara(C(:,12:19));
[CC4, results4]=swara(C(:,20:28));
[CC5, results5]=swara(C(:,29:30));
[CC6, results6]=swara(C(:,31:33));
CC=[CC1 CC2 CC3 CC4 CC5 CC6];
results=[results1 results2 results3 results4 results5 results6];

%                  Alternatives' ranking
wm=resultsm(end,:);
ws=results(end,:);
w=[wm(1).*ws(1:3)  wm(2).*ws(4:11) wm(3).*ws(12:19) wm(4) wm(5).*ws(20:28)  wm(6).*ws(29:30)  wm(7).*ws(31:33)];
C=[1	0	0	1	0	1	0	0	0	0	1	0	0	0	0	0	1	0	0	0	0	0	0	0	1	0	1	0	1	1	0	0	0	0
    1	0	0	1	0	1	0	0	0	0	0	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0
    0	0	0	1	0	0	0	0	0	0	0	0	1	0	0	0	0	1	1	0	0	0	1	0	0	1	0	1	0	0	0	1	0	0
    0	0	0	0	1	0	0	1	0	0	0	1	0	1	0	1	0	0	0	1	0	0	0	0	0	1	0	1	1	0	0	0	1	0
    0	0	0	1	1	0	1	1	0	0	1	1	0	0	0	0	0	0	1	0	0	0	0	1	1	0	0	0	1	0	0	0	1	1
    1	0	0	0	0	0	0	0	1	0	1	0	1	0	1	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0
    0	0	1	0	0	0	1	0	1	0	0	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	1	0	0	0	0	1	0	0
    1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	0	0	1	0	1	0	0	0	0	0	0
    0	0	1	1	0	0	0	0	0	0	0	0	0	1	0	0	1	0	1	0	0	0	0	1	0	1	1	0	1	0	0	0	1	0
    0	0	1	0	0	0	0	1	1	1	0	0	0	1	0	0	0	0	0	0	0	1	0	1	1	0	1	0	0	0	0	1	0	0
    0	0	0	0	0	0	0	0	0	0	0	1	1	0	1	1	0	0	0	1	0	0	0	1	0	0	0	1	0	0	1	0	0	0
    0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	1	0	0	1	1	0	1	1	1	1	1	0	1	1	0	0	0	0
    0	0	1	0	0	1	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0
    1	0	1	0	1	0	0	0	0	0	0	0	1	1	0	0	1	0	0	1	0	0	0	0	0	1	0	1	0	0	0	0	0	0
    0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0
    0	0	1	1	1	0	0	0	0	0	0	0	0	1	1	0	1	0	0	0	0	0	0	0	0	0	1	0	0	1	0	0	0	0
    0	0	1	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0
    1	1	1	0	0	0	0	0	1	1	1	0	0	1	0	1	1	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0
    0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	1	0	0	1	0	1	1	0	1
    1	1	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	1	1	1	1	0	1	1	0	0	0	1	0	0	0
    0	0	0	1	0	1	1	0	0	0	0	0	0	1	0	0	0	0	0	1	1	0	0	0	1	0	0	0	1	0	0	0	0	0
    1	1	0	1	0	0	1	0	0	0	0	0	1	0	0	0	1	0	0	1	0	0	1	0	1	0	1	0	1	1	0	0	1	0
    0	0	1	0	1	0	0	0	1	1	0	0	0	1	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	0	0	0
    0	1	1	0	0	0	0	0	1	1	1	0	0	0	1	0	1	1	0	0	0	0	1	0	0	0	0	0	1	0	0	0	0	0
    0	0	1	0	0	0	0	0	0	1	1	0	1	0	0	0	1	0	1	1	0	0	0	0	0	0	0	0	0	1	0	1	0	0
    0	0	0	0	1	0	0	0	0	1	0	0	0	1	1	1	1	0	0	0	0	1	0	1	1	1	1	1	1	0	0	0	0	0
    0	0	1	0	1	0	0	0	0	1	0	0	1	0	0	1	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0
    0	0	1	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	1	1	0	0	0	1	1	0
    0	0	1	0	0	1	0	0	0	0	0	1	0	1	0	0	0	1	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0
    0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	1	0	1	0	0	1	1	0	1	0	0	0	0	0	1	0	1
    1	0	1	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	1	0	1	0	0	0	0	0
    0	1	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0
    0	0	1	0	1	0	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	1	1	0	0	0	1	1	1	0	1	0	1
    1	0	1	0	1	0	0	0	0	0	1	0	1	0	0	0	0	0	0	1	0	0	0	0	0	0	1	1	0	1	0	0	0	0
    0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	1
    0	1	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	1	1	0	0	0	0	1	0	0	0	1	0	1	0
    1	1	0	1	0	0	0	0	0	0	1	0	1	1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    1	0	1	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0
    0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	1	0	0	0	1	0	0
    0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    0	1	1	1	1	0	0	1	0	1	1	0	0	0	0	0	0	1	0	0	0	1	0	1	0	0	0	0	0	0	0	1	0	0
    0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	1	0	0	1	0	0	0	0	0	0	0	0	1	0	0
    0	1	1	0	1	0	1	0	0	0	0	1	0	0	1	1	1	1	0	0	0	0	0	1	0	1	0	1	0	1	0	0	0	0
    0	0	1	0	0	0	1	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	1	0	0	0	0	0	0	0	1
    0	1	1	0	0	0	1	0	0	0	0	1	0	1	0	1	1	1	0	1	1	0	0	0	0	0	0	0	0	1	0	1	1	0
    0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	1	0	0	0	1
    1	0	0	0	1	0	0	0	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	1	1	0	0	0
    0	1	0	0	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	0
    0	1	1	1	0	1	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0
    0	0	1	1	0	0	1	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0
    0	0	1	0	0	0	0	0	0	1	0	0	1	1	0	0	0	1	1	0	0	0	0	1	0	0	0	0	0	0	1	0	0	0
    0	0	0	1	0	1	0	0	0	0	0	0	0	1	0	0	1	0	0	1	0	0	1	1	0	0	0	0	0	0	0	0	0	0
    0	0	1	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	1	0	1	1	0	0	0	0	1
    0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	0	1	0	0	1	1	0	0	1	1
    0	0	1	0	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	1	0	0	0	0	0
    0	1	0	1	0	1	0	0	0	0	0	0	0	1	0	0	1	0	0	0	1	0	1	0	0	1	0	1	0	1	0	0	0	0
    1	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	0	0	1	0	1	1	0	0	0	0	0	0	0	1	1	1	0	0
    0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	1	0	0	0
    0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	1	0	0	0	0	1	0	1
    0	1	1	0	0	1	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];

MM=ones(size(w));
[rank,y,grey_corr,ideal_pos,ideal_neg,S,R,Q]=grey_vikor(C,w,MM,0.1,0.5);

A1=[grey_corr;ideal_pos;ideal_neg];
A2=[S R Q rank];

%%                Senstivity Analysis
W0=w;
[WS, allpha]=genrate_weight(W0,8);
rank11=zeros(60,10);
for i=1:10
    [r,y,grey_corr,ideal_pos,ideal_neg,S,R,Q]=grey_vikor(C,WS(i,:),MM,0.1,0.5);
    rank11(:,i)=r';
end

rank_nu=zeros(60,10);
i=0;
for nu=0.1:0.1:1
    [rank,y,grey_corr,ideal_pos,ideal_neg,S,R,Q]=grey_vikor(C,w,MM,0.1,nu);
    i=i+1;
    rank_nu(:,i)=rank;
end

%  %%       1
% R=rank11;
% r=R(:,1);
% R=R(:,2:end);
% for i=1:9
%     cc(i)=corr(r,R(:,i));
% end
%
% [WS;allpha]